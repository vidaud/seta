import*as e from"react";import t from"primereact/api";import{useResizeListener as r,useOverlayScrollListener as n,useMountEffect as o,useUpdateEffect as u,useUnmountEffect as i}from"primereact/hooks";import{Portal as a}from"primereact/portal";import{DomHandler as c,ZIndexUtils as l,ObjectUtils as s,classNames as f}from"primereact/utils";function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p.apply(this,arguments)}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function m(e,t){if("object"!==d(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function h(e){var t=m(e,"string");return"symbol"===d(t)?t:String(t)}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){if(Array.isArray(e))return v(e)}function g(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function b(e,t){if(e){if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}function E(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e){if(Array.isArray(e))return e}function T(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,u,i,a=[],c=!0,l=!1;try{if(u=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=u.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return a}}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,t){return w(e)||T(e,t)||b(e,t)||S()}var O=e.memo(e.forwardRef((function(d,m){var v=x(e.useState(!1),2),w=v[0],T=v[1],S=x(e.useState(d.position),2),j=S[0],k=S[1],A=x(e.useState(""),2),I=A[0],C=A[1],D=e.useRef(null),H=e.useRef(null),L=e.useRef(null),N=e.useRef(null),R=e.useRef(!0),P=e.useRef({}),W=e.useRef(null),B=x(r({listener:function(e){!c.isTouchDevice()&&te(e)}}),2),Z=B[0],F=B[1],M=x(n({target:L.current,listener:function(e){te(e)},when:w}),2),Y=M[0],_=M[1],z=function(e){return $(e,"mousetrack")||d.mouseTrack},K=function(e){return"true"===$(e,"disabled")||q(e,"disabled")||d.disabled},U=function(e){return $(e,"showondisabled")||d.showOnDisabled},X=function(){return $(L.current,"autohide")||d.autoHide},$=function(e,t){return q(e,"data-pr-".concat(t))?e.getAttribute("data-pr-".concat(t)):null},q=function(e,t){return e&&e.hasAttribute(t)},G=function(e){var t=[$(e,"showevent")||d.showEvent],r=[$(e,"hideevent")||d.hideEvent];if(z(e))t=["mousemove"],r=["mouseleave"];else{var n=$(e,"event")||d.event;"focus"===n&&(t=["focus"],r=["blur"]),"both"===n&&(t=["focus","mouseenter"],r=["blur","mouseleave"])}return{showEvents:t,hideEvents:r}},J=function(e){return{top:$(e,"mousetracktop")||d.mouseTrackTop,left:$(e,"mousetrackleft")||d.mouseTrackLeft}},Q=function(e,t){if(H.current){var r=$(e,"tooltip")||d.content;r?(H.current.innerHTML="",H.current.appendChild(document.createTextNode(r)),t()):d.children&&t()}},V=function(e){Q(L.current,(function(){var r=W.current,n=r.pageX,o=r.pageY;d.autoZIndex&&!l.get(D.current)&&l.set("tooltip",D.current,t.autoZIndex,d.baseZIndex||t.zIndex.tooltip),D.current.style.left="",D.current.style.top="",X()&&(D.current.style.pointerEvents="none"),!z(L.current)&&"mouse"!=e||N.current||(N.current={width:c.getOuterWidth(D.current),height:c.getOuterHeight(D.current)}),re(L.current,{x:n,y:o},e)}))},ee=function(e){L.current=e.currentTarget;var t,r=K(L.current);(t=U(L.current)&&r?L.current.firstChild:L.current,!(d.content||$(t,"tooltip")||d.children))||r||(W.current=e,w?ce("updateDelay",V):le(d.onBeforeShow,{originalEvent:e,target:L.current})&&ce("showDelay",(function(){T(!0),le(d.onShow,{originalEvent:e,target:L.current})})))},te=function(e){(se(),w)&&(le(d.onBeforeHide,{originalEvent:e,target:L.current})&&ce("hideDelay",(function(){(X()||!1!==R.current)&&(l.clear(D.current),c.removeClass(D.current,"p-tooltip-active"),T(!1),le(d.onHide,{originalEvent:e,target:L.current}))})))},re=function(e,t,r){var n=0,o=0,u=r||j;if((z(e)||"mouse"==u)&&t){var i={width:c.getOuterWidth(D.current),height:c.getOuterHeight(D.current)};n=t.x,o=t.y;var a=J(e),l=a.top,s=a.left;switch(u){case"left":n-=i.width+s,o-=i.height/2-l;break;case"right":case"mouse":n+=s,o-=i.height/2-l;break;case"top":n-=i.width/2-s,o-=i.height+l;break;case"bottom":n-=i.width/2-s,o+=l}n<=0||N.current.width>i.width?(D.current.style.left="0px",D.current.style.right=window.innerWidth-i.width-n+"px"):(D.current.style.right="",D.current.style.left=n+"px"),D.current.style.top=o+"px",c.addClass(D.current,"p-tooltip-active")}else{var f=c.findCollisionPosition(u),p=$(e,"my")||d.my||f.my,m=$(e,"at")||d.at||f.at;D.current.style.padding="0px",c.flipfitCollision(D.current,e,p,m,(function(e){var t=e.at,r=t.x,n=d.at?"center"!==r&&r!==e.my.x?r:t.y:e.at["".concat(f.axis)];D.current.style.padding="",k(n),ne(n),c.addClass(D.current,"p-tooltip-active")}))}},ne=function(e){if(D.current){var t=getComputedStyle(D.current);"left"===e?D.current.style.left=parseFloat(t.left)-2*parseFloat(t.paddingLeft)+"px":"top"===e&&(D.current.style.top=parseFloat(t.top)-2*parseFloat(t.paddingTop)+"px")}},oe=function(){X()||(R.current=!1)},ue=function(e){X()||(R.current=!0,te(e))},ie=function(e){if(e){var t=G(e),r=t.showEvents,n=t.hideEvents,o=fe(e);r.forEach((function(e){return o.addEventListener(e,ee)})),n.forEach((function(e){return o.addEventListener(e,te)}))}},ae=function(e){if(e){var t=G(e),r=t.showEvents,n=t.hideEvents,o=fe(e);r.forEach((function(e){return o.removeEventListener(e,ee)})),n.forEach((function(e){return o.removeEventListener(e,te)}))}},ce=function(e,t){se();var r=$(L.current,e.toLowerCase())||d[e];r?P.current["".concat(e)]=setTimeout((function(){return t()}),r):t()},le=function(e){if(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=e.apply(void 0,r);return void 0===o&&(o=!0),o}return!0},se=function(){Object.values(P.current).forEach((function(e){return clearTimeout(e)}))},fe=function(e){if(e){if(U(e)){if(e.hasWrapper)return e.parentElement;var t=document.createElement("span");return e.parentNode.insertBefore(t,e),t.appendChild(e),e.hasWrapper=!0,t}var r;return e.hasWrapper&&((r=e.parentElement).replaceWith.apply(r,y(n=e.parentElement.childNodes)||g(n)||b(n)||E()),delete e.hasWrapper),e}var n;return null},pe=function(e){me(e),de(e)},de=function(e){he(e||d.target,ie)},me=function(e){he(e||d.target,ae)},he=function(e,t){if(e=s.getRefElement(e))if(c.isElement(e))t(e);else{var r=function(e){c.find(document,e).forEach((function(e){t(e)}))};e instanceof Array?e.forEach((function(e){r(e)})):r(e)}};o((function(){de(),w&&L.current&&K(L.current)&&te()})),u((function(){return de(),function(){me()}}),[ee,te,d.target]),u((function(){if(w){var e=$(L.current,"position")||j,t=$(L.current,"classname");k(e),C(t),V(e),Z(),Y()}else k(d.position),C(""),L.current=null,N.current=null,R.current=!0;return function(){F(),_()}}),[w]),u((function(){w&&ce("updateDelay",(function(){Q(L.current,(function(){re(L.current)}))}))}),[d.content]),i((function(){se(),me(),l.clear(D.current)})),e.useImperativeHandle(m,(function(){return{props:d,updateTargetEvents:pe,loadTargetEvents:de,unloadTargetEvents:me,show:ee,hide:te,getElement:function(){return D.current},getTarget:function(){return L.current}}}));var ve,ye,ge,be,Ee,we,Te;if(w){var Se=(Ee=s.findDiffKeys(d,O.defaultProps),we=f("p-tooltip p-component",(ve={},ye="p-tooltip-".concat(j),ge=!0,(ye=h(ye))in ve?Object.defineProperty(ve,ye,{value:ge,enumerable:!0,configurable:!0,writable:!0}):ve[ye]=ge,ve),d.className,I),be=L.current,Te=!(d.content||$(be,"tooltip")),e.createElement("div",p({id:d.id,ref:D,className:we,style:d.style,role:"tooltip","aria-hidden":w},Ee,{onMouseEnter:oe,onMouseLeave:ue}),e.createElement("div",{className:"p-tooltip-arrow"}),e.createElement("div",{ref:H,className:"p-tooltip-text"},Te&&d.children)));return e.createElement(a,{element:Se,appendTo:d.appendTo,visible:!0})}return null})));O.displayName="Tooltip",O.defaultProps={__TYPE:"Tooltip",appendTo:null,at:null,autoHide:!0,autoZIndex:!0,baseZIndex:0,className:null,content:null,disabled:!1,event:null,hideDelay:0,hideEvent:"mouseleave",id:null,mouseTrack:!1,mouseTrackLeft:5,mouseTrackTop:5,my:null,onBeforeHide:null,onBeforeShow:null,onHide:null,onShow:null,position:"right",showDelay:0,showEvent:"mouseenter",showOnDisabled:!1,style:null,target:null,updateDelay:0};export{O as Tooltip};
